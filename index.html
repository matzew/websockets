<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>WebSocket - here we are!</title>

		<meta name="description" content="WebSocket">
		<meta name="author" content="Matthias Wessendorf">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/aerogear.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h2>WebSockets</h2>
					<div>
						<img style="background: none;border: 0;" src="assets/img/connectivity.png" alt="" />
					</div>
					<h2>HTML5 Connectivity</h2>
				</section>
<section>
	<h2>Matthias We√üendorf</h2>
    <div style="float:right;text-align:right;display:inline-block;width: 16%">
        <img src="assets/img/redhat-logo-cloud.jpeg" width="90%"/>
    </div>
	<ul>
		<li>JBoss by Red Hat</li>
		<i><a href="http://twitter.com/AeroGears">@AeroGears</a></i>
		<li>Member Apache Software Foundation</li>
		<li>Speaker, Author, Blogger:</li>
		<i><a href="http://wessendorf.net">http://wessendorf.net</a></i>
		<li>Twitter:</li>
		<i><a href="http://twitter.com/mwessendorf">@mwessendorf</a></i>
	</ul>
</section>

				<section>
					<h2>Agenda</h2>
					<ul>
						<li>HTML5 Connectivity and Realtime</li>
						<li>Enter WebSockets</li>
						<li>Current usage</li>
						<li>Outlook: what's next?</li>
					</ul>
				</section>
				<section>
					<h2>HTML5 - haz it...</h2>
					<div>
						<img style="background: transparent;border: 0;" src="assets/img/HTML5-Super-Logo.jpeg" alt="" />
					</div>
				</section>

				<section>
					<h3>Ok...</h3>
					<h1>WebSocket</h1>
					<h3>But why?</h3>
				</section>

				<section>
					<h2>Realtime...</h2>
					<div>
						<img style="background: transparent;border: 0;" src="assets/img/realtime.png" alt="" />
					</div>
				</section>
				<section>
					<h2>Realtime...</h2>
					<div>
						<img style="background: transparent;border: 0;" src="assets/img/29465860.jpeg" alt="" />
					</div>
				</section>

				<section>
					<h2>HTTP Limits...</h2>
					<div>
						<img style="background: transparent;border: 0;height: 304px;width: 400px;" src="assets/img/oneway.gif" alt="" />
					</div>
				</section>

				<section>
					<h3>...it's chatty!</h3>
					<div>
						<img style="background: transparent;border: 0;" src="assets/img/headers.png" alt="" />
					</div>
				</section>

				<section>
					<h3>Web Scale??</h3>
					<div>
						<a href="./assets/img/http.png"><img style="background: transparent;border: 0;" src="assets/img/http.png" alt="" /></a>
					</div>
				</section>

				<section>
					<h3>ZOMG!</h3>
					<div>
						<a href="./assets/img/websocket.png"><img style="background: transparent;border: 0;" src="assets/img/websocket.png" alt="" /></a>
					</div>
				</section>
				<section>
					<h2>Agenda</h2>
					<ul>
						<li>HTML5 Connectivity and Realtime</li>
						<li><span style="text-decoration: underline;"><b><i>Enter WebSockets</i></b></span></li>
						<li>Current usage</li>
						<li>Outlook: what's next?</li>
					</ul>
				</section>

				<section>
					<h2>WS: History - hixie</h2>
					<ul>
						<li>2009, January</li>
						  <ul>
							<li>Version 0, kick off</li>
						  </ul>
						...
						<li>2010, May</li>
						  <ul>
							<li>Version 76</li>
						  </ul>
					</ul>
				</section>

				<section>
					<h2>WS: IETF took over</h2>
					<ul>
						<li>2010, August</li>
						  <ul>
							<li>Version 1, Binary</li>
						  </ul>
						<li>2011, January</li>
						  <ul>
							<li>Version 4, Security</li>
						  </ul>
						<li>2011, September</li>
						  <ul>
							<li>Version 14, Versioning</li>
						  </ul>
						<li>2011, December</li>
						  <ul>
							<li><i><b>RFC 6455</b></i> => FINAL</li>
						  </ul>
					</ul>
				</section>
				<section>
					<h2>Supported by...</h2>
					<ul>
						<li>Browsers</li>
						  <ul>
							<li>almost all! Yes... IE, but in version 10...</li>
						  </ul>
						<li>Servers</li>
						  <ul>
							<li>a gazillion servers</li>
						  </ul>
						<li>standalone(?) libraries</li>
						  <ul>
							<li>Autobahn, SRWebSocket, JavaEE(!) etc...</li>
						  </ul>
						<li>Extensions and Protocols</li>
						  <ul>
							<li>e.g. STOMP, MQTT, SimplePush (designed for Firefox OS)</li>
						  </ul>
					</ul>
				</section>
				<section data-markdown>
					<h3>Handshake Request</h3>
					```
					GET /chat HTTP/1.1
					Host: server.example.com
					Upgrade: websocket
					Connection: Upgrade
					Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ==
					Origin: http://example.com
					Sec-WebSocket-Protocol: chat, superchat
					Sec-WebSocket-Version: 13
					```
			</section>
			<section data-markdown>
				<h3>Handshake Response</h3>
				```
				HTTP/1.1 101 Switching Protocols
				Upgrade: websocket
				Connection: Upgrade
				Sec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=
				Sec-WebSocket-Protocol: superchat
				```
			</section>
				
			<section data-markdown>
				<h3>JavaScript API</h3>
				```
				// Create new WebSocket
				var mySocket =new WebSocket("ws://echo.websockets.org");

				// Attach listeners
				mySocket.onmessage = function(evt) {

				   doSomethingFancy(evt.data);
				};

				mySocket.onopen = function(evt) {...};

				mySocket.onclose = function(evt) {...};

				mySocket.onerror = function(evt) {...};

				```
			</section>
				
			<section data-markdown>
				<h3>JavaScript API</h3>
				```
				function sendTextMessage() {
				    if (mySocket.readyState !== WebSocket.OPEN) return;

				    mySocket.send("Hello there...!");
				 }

				 function sendBinaryMessage() {
				    if (mySocket.readyState !== WebSocket.OPEN) return;

				    mySocket.send(canvasElementRef.toBlob()); // blob: default...
				 }

				// Close WebSocket
				mySocket.close();
				```
			</section>
				<section>
					<h2>ARE YOU READY TO CONNECT TO</h2>
					<div>
						<img style="background: transparent;border: 0;" src="assets/img/hp.jpg" alt="" />
					</div>
					<h2>WEBSOCKETS ????</h2>
				</section>

			<section>
				<h2>JSR 356</h2>
				<ul>
					<li>Java API for WebSocket</li>
					<ul>
						<li>Client API</li>
						<li>Server API</li>
					</ul>
				</ul>
			</section>
			
			<section>
				<h2>Agenda</h2>
				<ul>
					<li>HTML5 Connectivity and Realtime</li>
					<li>Enter WebSockets</li>
					<ul>
						<li><span style="text-decoration: underline;"><b><i>Issues / Gotchas</i></b></span></li>
					</ul>
					<li>Current usage</li>
					<li>Outlook: what's next?</li>
				</ul>
			</section>
			
			<section>
				<img style="background: transparent;border: 0;height: 720px;width: 720px;" src="assets/img/29697984.jpeg" alt="" />
			</section>
			
			<section>
				<h2>WebSocket Issues</h2>
				<ul>
					<li>Browsers</li>
					 	<ul>
							<li>different protocol/API versions..</li>
							<li>old browsers...</li>
						</ul>
					<li>Servers</li>
				 	<ul>
						<li>different protocol/API versions..</li>
						<li>old handshake VS new handshake</li>
					</ul>					
				</ul>
			</section>
			<!--section>
				<h2>relax</h2>
				<span> Can be fixed, but requires some more code and tweaks...</span>
			</section-->



			<section>
				<h2>WebSocket Issues</h2>
				<ul>
					<li>Writing to a closed WebSocket:</li>
					<ul>
						<li>e.g. race condition...</li>
					</ul>
				</ul>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p><a href="https://github.com/joewalnes/reconnecting-websocket">reconnecting-websocket</a>
			</section>
			<section data-markdown>
				<h3>open?</h3>
				```
				function sendTextMessage() {
				    if (mySocket.readyState !== WebSocket.OPEN) return;

				    mySocket.send("Hello there...!");
				 }
				```
				The readySate:
				```
				WebSocket.CONNECTING
				WebSocket.OPEN
				WebSocket.CLOSING
				WebSocket.CLOSED
				```
			</section>
			<section>
				<h2>WebSocket Issues</h2>
				<ul>
					<li>Browsers..WAT CAN GO WRONG ???</li>
					<br/><p/>
					<ul>
						<li>recent (FF/Chrome): for ws:// from TLS (https://)....</li>
						<li>older Firefox: ESC... true for XHR (and Comet) as well.....</li>
					</ul>
				</ul>
			</section>
			
			<section>
				<h2>(WebSocket) Issues</h2>
				<ul>
					<li>Sending invalid UTF-8</li>
					<ul>
						<li>emoji / emoticons</li>
					</ul>
				</ul>
			</section>
			<section>
				<h2>(WebSocket) Issues</h2>
				<p>&nbsp;</p>
				<p>encodeURIComponent(<img src="assets/img/poo.png" style="border:0;weight:60px;height:60px;background:transparent;"/>)</p>
				<p>&nbsp;</p>
			</section>

			<section>
				<p>WebSockets</p>
				<p>on</p>
				<h1>mobile ???</h1>
			</section>

			<section>
				<h2>(WebSocket) Issues</h2>
				<ul>
					<li>Browser</li>
					<ul>
						<li>Sleep closes the connection</li>
					</ul>
					<li>Native</li>
					<ul>
						<li>it depends....</li>
					</ul>
				</ul>
			</section>

			<section data-markdown>
				<h2>WebSocket (Browser) Issues</h2>
				```
				mySocket.onclose = function(evt) {
					// something happend:
					if (!evt.wasClean) {
						// add hooks...
					}
				};
				```
				Apache Cordova...
			</section>

			<section data-markdown>
				<h2>Future => </h2>
				Page Visibility API (W3C)
				```
				document.addEventListener("visibilitychange", function(event) {
				   // Page visible ?
				   if (document.hidden) {
				   }
				   // query the 'visibilityState':
				   var myVisibility = document.visibilityState;
				   ...
				}, false);
				```
				* hidden
				* visible
				*  preview
			</section>


			<section>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<h1>3G ?</h1>
				<p>&nbsp;</p>
			</section>

			<section>
				<h2>Browser...</h2>
				<img style="background: transparent;border: 0;" src="assets/img/ws_org.jpg" alt="" />
			</section>
			<section>
				<h2>...native</h2>
				<img style="background: transparent;border: 0;" src="assets/img/pusher_1.jpg" alt="" />
			</section>
			<section>
				<h2>Oh, look!</h2>
				<img style="background: transparent;border: 0;" src="assets/img/pusher_2.jpg" alt="" />
			</section>
			<section data-markdown>
				<p>&nbsp;</p>
				<h1>WebSocket secure</h1>
				<p>&nbsp;</p>
				```
				var ws = new WebSocket("wss://myserver.com/endpoint");
				```
			</section>
			<section>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<h1>Always!</h1>
				<p>&nbsp;</p>
				<span>Doesn't <span style="color:#E25027">http://</span> just look odd ? :-)</span>
			</section>

			<section>
				<h2>Actually...</h2>
				<ul>
					<li>Telekom fixed it :)</li>
					<li>BUT! Do you know if others support it ?</li>
				</ul>
			</section>

			<section>
				<h2>Android/iOS</h2>
				<ul>
					<li>Costs of maintaining (WebSocket) connection (per app)</li>
					<li>sporadic connection scenario</li>
						<ul>
							<li>network events</li>
							<li>battery</li>
							<li>redelivery of messages</li>
						</ul>
					<li>user kills the app</li>
					<li>reboot of device</li>
				</ul>
			</section>


				<section>
					<h2>Ideal case</h2>
					<div>
						<img style="background: transparent;border: 0;" src="assets/img/Device-Cloud.png" alt="" />
					</div>
				</section>
				<section>
					<h2>Background*</h2>
					<div>
						<img style="background: transparent;border: 0;" src="assets/img/Device-Cloud2.png" alt="" />
					</div>
				</section>
				<section>
					<h2>Push for wake up!</h2>
					<div>
						<img style="background: transparent;border: 0;" src="assets/img/Device-Cloud3.png" alt="" />
					</div>
				</section>
				<section>
					<h2>Back to 'normal'</h2>
					<div>
						<img style="background: transparent;border: 0;" src="assets/img/Device-Cloud.png" alt="" />
					</div>
				</section>


			
			<section>
				<h2>Enterprise Proxies</h2>
				<ul>
					<li>blocks (high) ports...</li>
					<li>allows: 80, 443, 843</li>
				</ul>
			</section>
			
			
			<section>
				<h2>(WebSocket) Issues</h2>
				<ul>
					<li>(Personal) Firewalls</li>
					<li>Virus Scanners</li>
				</ul>
				<p>there is some really old software out there...</p>
			</section>
			
			
			
			<section>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<h1>How to improve?!</h1>
				<p>&nbsp;</p>
			</section>

			<section data-markdown>
				<p>&nbsp;</p>
				<h1>WebSocket secure</h1>
				<p>&nbsp;</p>
				```
				var ws = new WebSocket("wss://myserver.com/endpoint");
				```
			</section>
			
			
			<section>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<h1>Fallbacks!</h1>
				<p>&nbsp;</p>
			</section>

			
			<section>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<h1>Really !?!?!?</h1>
				<p>&nbsp;</p>
			</section>

			
			<section>
				<h2>Engine.io / Socket.io</h2>
				<ul>
					<li>Engine.io transport for Socket.io</li>
					<li>They upgrade to WebSocket, if possible...</li>
			</section>
			
			
			<section>
				<h2>Engine.io / Socket.io</h2>
				<img style="background: transparent;border: 0;" src="assets/img/engine.io.png" alt="" />
				<p>Use multiple ports, if possible(80, 443, 843)</p>
			</section>
				
			<section>
				<h2>ENTERPRISE.JS</h2>
				<ul>
					<li>A good API should hide the technical facts</li>
					<li>Devs should code against one API</li>
				</ul>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>...like Socket.io does!</p>
			</section>
			


			<section>
				<h2>Agenda</h2>
				<ul>
					<li>HTML5 Connectivity and Realtime</li>
					<li>Enter WebSockets</li>
					<li><span style="text-decoration: underline;"><b><i>Current usage</i></b></span></li>
					<li>Outlook: what's next?</li>
				</ul>
			</section>
			
			
			<section>
				<h2>WebSocket usage</h2>
				<ul>
					<li>APIs over WebSocket</li>
					<li>Protocols over WebSocket</li>
					<li>APIs integration with WebSocket</li>
					<li>Mobile</li>
				</ul>
			</section>
			
			<section>
				<h2>SimplePush</h2>
				<ul>
					<li>push websocket to Firefox and other devices</li>
				</ul>
			</section>
			
			
			<section>
				<h2>WebSocket usage</h2>
				<ul>
					<li>When you build Desktop applications (client server solutions) do you develop your application using raw TCP sockets?</li>
					<p>&nbsp;</p>
					<li>Or, are you using higher level protocols and APIs, such as XMPP, JMS, JDBC?</li>
				</ul>
			</section>
			
			<!--section>
				<h2>APIs over WebSocket</h2>
				<p>&nbsp;</p>
				<p>Infinispan (Demo)</p>
			</section-->
			
			<section>
				<h2>CDI meets WebSocket</h2>
			</section>
			
			<section>
				<img style="background: transparent;border: 0;" src="assets/img/table_football.jpg" alt="" />
			</section>
			
			<section>
				<h2>APIs / Protocols over WebSocket</h2>
				<p>&nbsp;</p>
				<p>Stomp / HornetQ (Demo)</p>
			</section>
			
			<section>
				<h2>Agenda</h2>
				<ul>
					<li>HTML5 Connectivity and Realtime</li>
					<li>Enter WebSockets</li>
					<li>Current usage</li>
					<li><span style="text-decoration: underline;"><b><i>Outlook: what's next?</i></b></span></li>
				</ul>
			</section>
			
			<section>
				<h2>Moving on</h2>
				<ul>
					<li>Subprotocols (IANA)</li>
					<ul>
						<li><a href="http://stomp.github.com/stomp-specification-1.0.html">STOMP 1.0****</a>, <a href="http://wamp.ws">WAMP</a>, <a href="http://tools.ietf.org/html/draft-hapner-hybi-messagebroker-subprotocol">Message Broker</a>, <a href="http://msdn.microsoft.com/en-us/library/hh536812%28prot.20%29.aspx">SOAP...</a></li>
					</ul>
					<li>Extensions</li>
					<ul>
						<li><a href="http://tools.ietf.org/html/draft-ietf-hybi-websocket-multiplexing-08">Multiplexing*</a>, <a href="http://tools.ietf.org/html/draft-ietf-hybi-permessage-compression-04">Compresssion (per message)*</a></li>
					</ul>
					<p>&nbsp;</p>
					<li><a style="text-decoration:line-through" href="https://docs.google.com/document/d/1zUEFzz7NCls3Yms8hXxY4wGXJ3EEvoZc3GihrqPQcM0/edit?pli=1">WebSocket over SPDY</a></li>
					<p>&nbsp;</p>
				</ul>
			</section>

			<section>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<h1>HTTP 2.0</h1>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
			</section>
			
			<section>
				<h1>THANK YOU</h1>
				<h3>matzew @ redhat . com</h3>
				<ul>
					<li>https://github.com/matzew/websockets</li>
				</ul>
			</section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
					// { src: 'plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } }
					// { src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
